<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>ml4a :: MNIST confusion</title>

    <script src="../libraries/util.js"></script>
    <script src="../libraries/convnet.js" type="text/javascript"></script>
    
    <script src="../libraries/p5.js" type="text/javascript"></script>
    <script src="../libraries/p5.dom.js" type="text/javascript"></script>
    
    <script src="../datasets/mnist/mnist_labels.js" type="text/javascript"></script>
    
    <script src="../src/dataset.js" type="text/javascript"></script>
    <script src="../src/convnet.js" type="text/javascript"></script>
    <script src="../src/datavis.js" type="text/javascript"></script>

    <script>
      var dataset;
      var convnet;

      // rect of confusion matrix
      var x = 150;
      var y = 150;
      var w = 480;
      var h = 480;

      function setup() {
        createCanvas(1280, 700);
        noLoop();  
        dataset = new dataset();
        dataset.loadMNIST(setupNetwork);
      }

      function setupNetwork() {
        convnet = new convnet(dataset);
        convnet.add_layer({type:'fc', num_neurons:15, activation:'sigmoid'});
        convnet.add_layer({type:'softmax', num_classes:10});
        convnet.setup();
        convnet.train_next(5000);
        convnet.test_next(5000);
        draw_c();
      }

      function draw_c() {
        background(255);
        draw_confusion_sample_grid(convnet, x, y, w, w);
      }
    </script>

    <style> body {padding: 0; margin: 0;} canvas {vertical-align: top;} </style>
  </head>
  <body>
  </body>
</html>
